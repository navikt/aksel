function getTop(element, start) {
    // return value of html.getBoundingClientRect().top ... IE : 0, other browsers : -pageYOffset
    if (element.nodeName === 'HTML') {
        return -start;
    }
    return element.getBoundingClientRect().top + start;
}

function easeInOutCubic(t) {
    if (t < 0.5) {
        return 4 * t * t * t;
    }
    return ((t - 1) * ((2 * t) - 2) * ((2 * t) - 2)) + 1;
}

function position(start, end, elapsed, duration) {
    if (elapsed > duration) {
        return end;
    }
    return start + ((end - start) * easeInOutCubic(elapsed / duration));
}

export function scrollTo(el:any, duration:number = 500, callback?:Function) {
    const start = window.pageYOffset;
    if (!el) {
        return;
    }
    const end = getTop(el, start);

    const clock = Date.now();
    const requestAnimationFrame = window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        function (fn) {
            window.setTimeout(fn, 15);
        };

    const step = function () {
        const elapsed = Date.now() - clock;
        window.scroll(0, position(start, end, elapsed, duration));

        if (elapsed > duration) {
            if (typeof callback === 'function') {
                callback(el);
            }
        } else {
            requestAnimationFrame(step);
        }
    };
    step();
}

export function erSynligIViewport(element) {
    const rect = element.getBoundingClientRect();
    return (
        rect.top >= 0 &&
        rect.left >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
        rect.right <= (window.innerWidth || document.documentElement.clientWidth)
    );
}
